"use strict";(self["webpackChunkactive_dogs"]=self["webpackChunkactive_dogs"]||[]).push([[804],{5813:function(e,n,t){t.d(n,{Z:function(){return d}});var o=t(6252),l=t(3577);function r(e,n,t,r,a,s){const i=(0,o.up)("ion-loading"),u=(0,o.up)("ion-back-button"),d=(0,o.up)("ion-buttons"),c=(0,o.up)("ion-title"),w=(0,o.up)("ion-toolbar"),m=(0,o.up)("ion-header"),g=(0,o.up)("ion-content"),f=(0,o.up)("ion-page");return(0,o.wg)(),(0,o.j4)(f,null,{default:(0,o.w5)((()=>[e.loading?((0,o.wg)(),(0,o.j4)(i,{key:0})):((0,o.wg)(),(0,o.iD)(o.HY,{key:1},[(0,o.Wm)(m,null,{default:(0,o.w5)((()=>[(0,o.Wm)(w,null,{default:(0,o.w5)((()=>[e.backRoute?((0,o.wg)(),(0,o.j4)(d,{key:0,slot:"start"},{default:(0,o.w5)((()=>[(0,o.Wm)(u,{"default-href":e.backRoute},null,8,["default-href"])])),_:1})):(0,o.kq)("",!0),(0,o.Wm)(c,null,{default:(0,o.w5)((()=>[(0,o.Uk)((0,l.zw)(e.title),1)])),_:1})])),_:1})])),_:1}),(0,o.Wm)(g,{fullscreen:!0},{default:(0,o.w5)((()=>[(0,o.Wm)(m,{collapse:"condense"},{default:(0,o.w5)((()=>[(0,o.Wm)(w,null,{default:(0,o.w5)((()=>[(0,o.Wm)(d,{slot:"start"},{default:(0,o.w5)((()=>[(0,o.Wm)(u)])),_:1}),(0,o.Wm)(c,{size:"large"},{default:(0,o.w5)((()=>[(0,o.Uk)((0,l.zw)(e.title),1)])),_:1})])),_:1})])),_:1}),(0,o.WI)(e.$slots,"default")])),_:3})],64))])),_:3})}var a=t(255),s=(0,o.aZ)({name:"CourseDetail",components:{IonButtons:a.Sm,IonBackButton:a.oU,IonHeader:a.Gu,IonLoading:a.wh,IonToolbar:a.sr,IonTitle:a.wd,IonContent:a.W2,IonPage:a._i},props:{backRoute:{type:String,default:null},loading:{type:Boolean,default:!1},title:{type:String,default:""}}}),i=t(3744);const u=(0,i.Z)(s,[["render",r]]);var d=u},5804:function(e,n,t){t.r(n),t.d(n,{default:function(){return j}});var o=t(6252),l=t(3577);const r=(0,o.Uk)("Stunden"),a=(0,o.Uk)("Der Kurs hat noch keine Stunden ..."),s=(0,o.Uk)(" Weniger anzeigen "),i=(0,o.Uk)(" Alle anzeigen "),u=(0,o.Uk)(" Stunde hinzufügen "),d=(0,o.Uk)("Teilnehmer"),c=(0,o.Uk)("Der Kurs ist noch leer ..."),w={slot:"end",class:"buttons"},m=(0,o.Uk)(" € "),g=(0,o.Uk)(" Teilnehmer bearbeiten "),f=(0,o.Uk)(" Zurück zur Übersicht "),k=(0,o.Uk)(" Kurs löschen ");function h(e,n,t,h,p,_){const b=(0,o.up)("ion-label"),y=(0,o.up)("ion-list-header"),W=(0,o.up)("ion-icon"),U=(0,o.up)("ion-item"),C=(0,o.up)("ion-badge"),D=(0,o.up)("ion-button"),I=(0,o.up)("ion-list"),S=(0,o.up)("PageLayout");return(0,o.wg)(),(0,o.j4)(S,{"back-route":"/tabs/course",loading:!e.course,title:e.course?.name},{default:(0,o.w5)((()=>[e.course?((0,o.wg)(),(0,o.iD)(o.HY,{key:0},[(0,o.Wm)(I,null,{default:(0,o.w5)((()=>[(0,o.Wm)(y,null,{default:(0,o.w5)((()=>[(0,o.Wm)(b,null,{default:(0,o.w5)((()=>[r])),_:1})])),_:1}),e.visibleCourseDates.length?((0,o.wg)(),(0,o.iD)(o.HY,{key:1},[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.visibleCourseDates,(n=>((0,o.wg)(),(0,o.j4)(U,{key:n.id,button:"","router-link":`/tabs/course/${e.course.id}/coursedatedetail/${n.id}`},{default:(0,o.w5)((()=>[(0,o.Wm)(b,null,{default:(0,o.w5)((()=>[(0,o.Uk)((0,l.zw)(new Date(n.date).toLocaleDateString())+": "+(0,l.zw)(n.topics.name),1)])),_:2},1024),(0,o.Wm)(C,{slot:"end"},{default:(0,o.w5)((()=>[(0,o.Uk)((0,l.zw)(n.cards?.length),1)])),_:2},1024)])),_:2},1032,["router-link"])))),128)),e.showCourseDateExpand||e.showAllCourseDates?((0,o.wg)(),(0,o.j4)(D,{key:0,onClick:n[0]||(n[0]=n=>e.showAllCourseDates=!e.showAllCourseDates),class:"ion-margin-horizontal ion-margin-top",size:"small",fill:"clear"},{default:(0,o.w5)((()=>[e.showAllCourseDates?((0,o.wg)(),(0,o.iD)(o.HY,{key:0},[s],64)):((0,o.wg)(),(0,o.iD)(o.HY,{key:1},[i],64))])),_:1})):(0,o.kq)("",!0)],64)):((0,o.wg)(),(0,o.j4)(U,{key:0,lines:"none"},{default:(0,o.w5)((()=>[(0,o.Wm)(W,{icon:e.pawOutline,slot:"start"},null,8,["icon"]),(0,o.Wm)(b,null,{default:(0,o.w5)((()=>[a])),_:1})])),_:1}))])),_:1}),(0,o.Wm)(D,{"router-link":`/tabs/course/${e.course.id}/createcoursedate`,color:"light",class:"ion-margin",expand:"block"},{default:(0,o.w5)((()=>[u])),_:1},8,["router-link"]),(0,o.Wm)(I,null,{default:(0,o.w5)((()=>[(0,o.Wm)(y,null,{default:(0,o.w5)((()=>[(0,o.Wm)(b,null,{default:(0,o.w5)((()=>[d])),_:1})])),_:1}),e.cards.length?((0,o.wg)(!0),(0,o.iD)(o.HY,{key:1},(0,o.Ko)(e.cards,(n=>((0,o.wg)(),(0,o.j4)(U,{key:n.id,button:"","router-link":`/tabs/course/${e.course.id}/carddetail/${n.id}`},{default:(0,o.w5)((()=>[(0,o.Wm)(b,null,{default:(0,o.w5)((()=>[(0,o.Uk)((0,l.zw)(n.customers.dogname)+" ("+(0,l.zw)(n.customers.name)+") ",1)])),_:2},1024),(0,o._)("div",w,[(0,o.Wm)(D,{color:n.payed?"success":"light",onClick:t=>e.togglePayed(n)},{default:(0,o.w5)((()=>[n.payed?((0,o.wg)(),(0,o.j4)(W,{key:0,icon:e.checkmarkCircle,slot:"start"},null,8,["icon"])):((0,o.wg)(),(0,o.j4)(W,{key:1,icon:e.closeCircle,slot:"start"},null,8,["icon"])),m])),_:2},1032,["color","onClick"]),(0,o.Wm)(C,null,{default:(0,o.w5)((()=>[(0,o.Uk)((0,l.zw)(n.course_dates?.length)+" / 10",1)])),_:2},1024)])])),_:2},1032,["router-link"])))),128)):((0,o.wg)(),(0,o.j4)(U,{key:0,lines:"none"},{default:(0,o.w5)((()=>[(0,o.Wm)(W,{icon:e.pawOutline,slot:"start"},null,8,["icon"]),(0,o.Wm)(b,null,{default:(0,o.w5)((()=>[c])),_:1})])),_:1}))])),_:1}),(0,o.Wm)(D,{"router-link":`/tabs/course/${e.course.id}/editcustomer`,color:"light",class:"ion-margin ion-margin-bottom-large",expand:"block"},{default:(0,o.w5)((()=>[g])),_:1},8,["router-link"]),(0,o.Wm)(D,{expand:"block","router-link":"/tabs/course","router-direction":"back",color:"light",class:"ion-margin"},{default:(0,o.w5)((()=>[f])),_:1}),(0,o.Wm)(D,{expand:"block",onClick:e.deleteCourse,class:"ion-margin",color:"danger"},{default:(0,o.w5)((()=>[k])),_:1},8,["onClick"])],64)):(0,o.kq)("",!0)])),_:1},8,["loading","title"])}var p=t(2262),_=t(255),b=t(2119),y=t(7606),W=t(8903),U=t(5813),C=t(816),D=t(8219),I=t(7627),S=(0,o.aZ)({name:"CourseDetail",components:{PageLayout:U.Z,IonButton:_.YG,IonItem:_.Ie,IonLabel:_.Q$,IonList:_.q_,IonListHeader:_.yh,IonIcon:_.gu,IonBadge:_.yp},setup(){const e=(0,p.iH)(),n=(0,b.yj)(),t=(0,_.cj)(),{id:l}=n.params,r=(0,p.iH)(!1),a=(0,o.Fl)((()=>(0,p.SU)(e)?.course_dates||[])),s=(0,o.Fl)((()=>(0,p.SU)(r)?(0,p.SU)(a):(0,p.SU)(a).slice(0,3))),i=(0,o.Fl)((()=>(0,p.SU)(a).length>(0,p.SU)(s).length));async function u(){const n=await y.O.from("courses").select("\n          name,\n          id,\n          cards (\n            id,\n            payed,\n            customers (\n              id,\n              name,\n              dogname\n            ),\n            course_dates (\n              id\n            )\n          ),\n          course_dates (\n            id,\n            date,\n            topics (\n              name\n            ),\n            cards (\n              id\n            )\n          )\n        ").match({id:l}).order("date",{foreignTable:"course_dates",ascending:!1});n.error||(e.value=n.body[0])}async function d(){if(I.S.offline)return void C.h.error("Fehler beim Löschen. Keine Internetverbindung.");const n=await D.Z.confirm("Kurs wirklich löschen?",`Soll der Kurs "${(0,p.SU)(e).name}" endgültig gelöscht werden?`);if(!n)return;const o=(0,p.SU)(e).cards.map((({id:e})=>e)),r=(0,p.SU)(e).course_dates.map((({id:e})=>e));if(o.length){const{error:e}=await y.O.from("card_course_date").delete().in("card_id",o);if(e)return void C.h.error("Fehler beim Löschen der Stundenzuweisungen.",e)}if(o.length){const{error:e}=await y.O.from("cards").delete().in("id",o);if(e)return void C.h.error("Fehler beim Löschen der Kundenzuweisungen.",e)}if(r.length){const{error:e}=await y.O.from("course_dates").delete().in("id",r);if(e)return void C.h.error("Fehler beim Löschen der Stunden.",e)}const{error:a}=await y.O.from("courses").delete().match({id:l});a?C.h.error("Fehler beim Löschen des Kurses.",a):(C.h.success("Kurs erfolgreich gelöscht."),t.navigate("/tabs/course","back","push"))}async function c(e){const{error:n}=await y.O.from("cards").update({payed:!e.payed}).match({id:e.id});n?C.h.error("Fehler beim Ändern des Bezahlstatus.",n):u()}u(),(0,_.KA)(u);const w=(0,o.Fl)((()=>(0,p.SU)(e).cards.sort(((e,n)=>e.id-n.id))));return{course:e,visibleCourseDates:s,showAllCourseDates:r,showCourseDateExpand:i,cards:w,deleteCourse:d,togglePayed:c,pawOutline:W.WG6,checkmarkCircle:W.I1A,closeCircle:W.XZx}}}),v=t(3744);const z=(0,v.Z)(S,[["render",h],["__scopeId","data-v-5791f69e"]]);var j=z}}]);
//# sourceMappingURL=804.367e1b32.js.map