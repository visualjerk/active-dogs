"use strict";(self["webpackChunkactive_dogs"]=self["webpackChunkactive_dogs"]||[]).push([[26],{182:function(e,t,n){n.d(t,{Z:function(){return c}});var o=n(252),u=n(577);function r(e,t,n,r,l,a){const s=(0,o.up)("ion-checkbox"),i=(0,o.up)("ion-label"),d=(0,o.up)("ion-item"),c=(0,o.up)("ion-list");return(0,o.wg)(),(0,o.j4)(c,null,{default:(0,o.w5)((()=>[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.list,(t=>((0,o.wg)(),(0,o.j4)(d,{key:t.id},{default:(0,o.w5)((()=>[(0,o.Wm)(s,{slot:"start","onUpdate:modelValue":n=>e.toggleCustomer(t.id),modelValue:e.isCustomerChecked(t.id)},null,8,["onUpdate:modelValue","modelValue"]),(0,o.WI)(e.$slots,"default",(0,u.vs)((0,o.F4)(t)),(()=>[(0,o.Wm)(i,null,{default:(0,o.w5)((()=>[(0,o.Uk)((0,u.zw)(t.dogname)+" ("+(0,u.zw)(t.name)+")",1)])),_:2},1024)]))])),_:2},1024)))),128))])),_:3})}var l=n(262),a=n(255),s=(0,o.aZ)({name:"CustomerInputList",components:{IonCheckbox:a.nz,IonItem:a.Ie,IonLabel:a.Q$,IonList:a.q_},props:{list:{type:Array,default:()=>[]},modelValue:{type:Array,required:!0}},setup(e,{emit:t}){const n=(0,l.iH)(new Set);function u(e){return n.value.has(e)}function r(e){u(e)?n.value.delete(e):n.value.add(e),t("update:model-value",Array.from(n.value))}return(0,o.YP)((()=>e.modelValue),(()=>{n.value=new Set(e.modelValue)}),{immediate:!0}),{isCustomerChecked:u,toggleCustomer:r}}}),i=n(744);const d=(0,i.Z)(s,[["render",r]]);var c=d},63:function(e,t,n){n.d(t,{Z:function(){return d}});var o=n(252),u=n(577);function r(e,t,n,r,l,a){const s=(0,o.up)("ion-loading"),i=(0,o.up)("ion-back-button"),d=(0,o.up)("ion-buttons"),c=(0,o.up)("ion-title"),m=(0,o.up)("ion-toolbar"),f=(0,o.up)("ion-header"),p=(0,o.up)("ion-content"),g=(0,o.up)("ion-page");return(0,o.wg)(),(0,o.j4)(g,null,{default:(0,o.w5)((()=>[e.loading?((0,o.wg)(),(0,o.j4)(s,{key:0})):((0,o.wg)(),(0,o.iD)(o.HY,{key:1},[(0,o.Wm)(f,null,{default:(0,o.w5)((()=>[(0,o.Wm)(m,null,{default:(0,o.w5)((()=>[(0,o.Wm)(d,{slot:"start"},{default:(0,o.w5)((()=>[(0,o.Wm)(i,{"default-href":e.backRoute},null,8,["default-href"])])),_:1}),(0,o.Wm)(c,null,{default:(0,o.w5)((()=>[(0,o.Uk)((0,u.zw)(e.title),1)])),_:1})])),_:1})])),_:1}),(0,o.Wm)(p,{fullscreen:!0},{default:(0,o.w5)((()=>[(0,o.Wm)(f,{collapse:"condense"},{default:(0,o.w5)((()=>[(0,o.Wm)(m,null,{default:(0,o.w5)((()=>[(0,o.Wm)(d,{slot:"start"},{default:(0,o.w5)((()=>[(0,o.Wm)(i)])),_:1}),(0,o.Wm)(c,null,{default:(0,o.w5)((()=>[(0,o.Uk)((0,u.zw)(e.title),1)])),_:1})])),_:1})])),_:1}),(0,o.WI)(e.$slots,"default")])),_:3})],64))])),_:3})}var l=n(255),a=(0,o.aZ)({name:"CourseDetail",components:{IonButtons:l.Sm,IonBackButton:l.oU,IonHeader:l.Gu,IonLoading:l.wh,IonToolbar:l.sr,IonTitle:l.wd,IonContent:l.W2,IonPage:l._i},props:{backRoute:{type:String,default:null},loading:{type:Boolean,default:!1},title:{type:String,default:""}}}),s=n(744);const i=(0,s.Z)(a,[["render",r]]);var d=i},670:function(e,t,n){n.r(t),n.d(t,{default:function(){return v}});var o=n(252);const u=(0,o.Uk)(" Änderungen speichern "),r=(0,o.Uk)(" Zurück zum Kurs ");function l(e,t,n,l,a,s){const i=(0,o.up)("CustomerInputList"),d=(0,o.up)("ion-button"),c=(0,o.up)("PageLayout");return(0,o.wg)(),(0,o.j4)(c,{"back-route":`/tabs/course/${e.course?.id}`,loading:!e.course,title:`${e.course?.name} - Teilnehmer`},{default:(0,o.w5)((()=>[e.course?((0,o.wg)(),(0,o.iD)(o.HY,{key:0},[(0,o.Wm)(i,{list:e.customers,modelValue:e.selectedCustomerIds,"onUpdate:modelValue":t[0]||(t[0]=t=>e.selectedCustomerIds=t)},null,8,["list","modelValue"]),(0,o.Wm)(d,{expand:"block",onClick:e.saveCustomers,class:"ion-margin"},{default:(0,o.w5)((()=>[u])),_:1},8,["onClick"]),(0,o.Wm)(d,{class:"ion-margin",expand:"block","router-link":`/tabs/course/${e.course.id}`,"router-direction":"back",color:"light"},{default:(0,o.w5)((()=>[r])),_:1},8,["router-link"])],64)):(0,o.kq)("",!0)])),_:1},8,["back-route","loading","title"])}var a=n(262),s=n(255),i=n(119),d=n(606),c=n(63),m=n(182),f=n(816),p=n(120),g=(0,o.aZ)({name:"CourseEditCustomer",components:{IonButton:s.YG,PageLayout:c.Z,CustomerInputList:m.Z},setup(){const e=(0,a.iH)(),t=(0,i.yj)(),n=(0,s.cj)(),{id:o}=t.params,u=(0,a.iH)([]);async function r(){const t=await d.O.from("courses").select("\n          name,\n          id,\n          customers (\n            id\n          )\n        ").match({id:o});t.error||(e.value=t.body[0],u.value=e.value.customers.map((({id:e})=>e)))}r(),(0,s.KA)(r);const l=(0,a.iH)([]);async function c(){const e=await d.O.from("customers").select("name, dogname, id");e.error||(l.value=e.body)}async function m(e){f.h.error("Fehler beim Speichern der Änderungen.",e)}async function g(){if(p.S.offline)return void f.h.error("Fehler beim Speichern. Keine Internetverbindung.");const t=u.value,o=e.value.id,r=(0,a.SU)(e).customers.map((({id:e})=>e)),l=r.filter((e=>!t.includes(e))),s=t.filter((e=>!r.includes(e)));if(l.length){const e=await d.O.from("cards").delete().eq("course_id",o).in("customer_id",l);if(e.error)return void m(e.error)}const i=e=>({customer_id:e,course_id:o});if(s.length){const{error:e}=await d.O.from("cards").insert(s.map(i));if(e)return void m(e)}f.h.success("Teilnehmer erfolgreich gespeichert."),n.navigate(`/tabs/course/${e.value.id}`,"back","push")}return c(),(0,s.KA)(c),{course:e,customers:l,selectedCustomerIds:u,saveCustomers:g}}}),w=n(744);const k=(0,w.Z)(g,[["render",l]]);var v=k}}]);
//# sourceMappingURL=26.6bed4ea1.js.map